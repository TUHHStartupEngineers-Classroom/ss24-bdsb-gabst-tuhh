{
  "hash": "d0b0563da624e54139c3d271bd3f52ae",
  "result": {
    "markdown": "---\ntitle: \"Data Wrangling\"\nauthor: \"Gabriel Storch\"\n---\n\n# Loading of libraries\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-1_089c5086dfb128b766fb23305d23c0ae'}\n\n```{.r .cell-code}\nsuppressWarnings({\nlibrary(tidyverse)\nlibrary(vroom)\nlibrary(glue)\n})\n```\n:::\n\n\n# Loading the data\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-2_bc0f131995ff7b597c4d37b5e4d1775d'}\n\n```{.r .cell-code}\ndata_folder <- \"03_data/Patent_data_reduced/\"\n\ncol_types_patent <- list(\n  id = col_character(),\n  date = col_date(\"%Y-%m-%d\"),\n  num_claims = col_double()\n)\n\ncol_types_patent_assignee <- list(patent_id=col_character(),\n                                  assignee_id=col_character())\n\ncol_types_assignee <- list(id=col_character(),\n                               type=col_character(),\n                               organization=col_character())\n\n\ncol_types_uspc <- list(patent_id=col_character(),\n                       mainclass_id=col_character(),\n                       sequence=col_double())\n\npatent_tbl <- vroom(\n            file       = glue(\"{data_folder}patent.tsv\"), \n            delim      = \"\\t\", \n            col_types  = col_types_patent,\n            na         = c(\"\", \"NA\", \"NULL\")\n        )\n\npatent_assignee_tbl <- vroom(\n            file       = glue(\"{data_folder}patent_assignee.tsv\"), \n            delim      = \"\\t\", \n            col_types  = col_types_patent_assignee,\n            na         = c(\"\", \"NA\", \"NULL\")\n        )\n\nassignee_tbl <- vroom(\n            file       = glue(\"{data_folder}assignee.tsv\"), \n            delim      = \"\\t\", \n            col_types  = col_types_assignee,\n            na         = c(\"\", \"NA\", \"NULL\")\n        )\n\nuspc_tbl <- vroom(\n            file       = glue(\"{data_folder}uspc.tsv\"), \n            delim      = \"\\t\", \n            col_types  = col_types_uspc,\n            na         = c(\"\", \"NA\", \"NULL\")\n        )\n```\n:::\n\n\n# Top Ten US companies (patent-wise) 2014\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-3_dc1a5566c7d0fbf953184e523b60c5f8'}\n\n```{.r .cell-code}\npatent_tbl <- patent_tbl |> mutate(date=month(date)) |> rename(patent_id=id)\n\nus_assignee_tbl <- assignee_tbl[assignee_tbl$type == \"2\",] |> rename(assignee_id = id)\n\nus_patent_assignee_tbl <- patent_assignee_tbl |>\n  inner_join(us_assignee_tbl, by=\"assignee_id\")\n\ngrouped_us_patent_assignee_tbl <- us_patent_assignee_tbl |>\n  group_by(assignee_id) |>\n  summarise(num_patents=n()) |>\n  arrange(desc(num_patents))\n\n\nten_us_companies_with_most_patents <- inner_join(head(grouped_us_patent_assignee_tbl, 10), us_assignee_tbl, by=\"assignee_id\")[c(\"organization\", \"num_patents\")]\n\nten_us_companies_with_most_patents\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"organization\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"num_patents\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"International Business Machines Corporation\",\"2\":\"7547\"},{\"1\":\"Microsoft Corporation\",\"2\":\"3165\"},{\"1\":\"Google Inc.\",\"2\":\"2668\"},{\"1\":\"QUALCOMM Incorporated\",\"2\":\"2597\"},{\"1\":\"Apple Inc.\",\"2\":\"2201\"},{\"1\":\"General Electric Company\",\"2\":\"1873\"},{\"1\":\"Hewlett-Packard Development Company, L.P.\",\"2\":\"1638\"},{\"1\":\"AT&T INTELLECTUAL PROPERTY I, L.P.\",\"2\":\"1625\"},{\"1\":\"Intel Corporation\",\"2\":\"1616\"},{\"1\":\"GM Global Technology Operations LLC\",\"2\":\"1533\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n# Top Ten US companies (patent-wise) in August of 2014\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-4_8c107bb468b93f2d948e9d4917f02945'}\n\n```{.r .cell-code}\npatent_tbl_august <- patent_tbl[patent_tbl$date == 8,]\n\nten_us_companies_with_most_patents_august <- us_patent_assignee_tbl |>\n  inner_join(patent_tbl_august, by=\"patent_id\") |>\n  group_by(organization) |> \n  summarize(num_patents=n()) |> # counts rows \n  arrange(desc(num_patents)) |>\n  head(10)\n\nten_us_companies_with_most_patents_august\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"organization\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"num_patents\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"International Business Machines Corporation\",\"2\":\"718\"},{\"1\":\"Microsoft Corporation\",\"2\":\"337\"},{\"1\":\"Google Inc.\",\"2\":\"240\"},{\"1\":\"QUALCOMM Incorporated\",\"2\":\"223\"},{\"1\":\"Apple Inc.\",\"2\":\"222\"},{\"1\":\"Intel Corporation\",\"2\":\"159\"},{\"1\":\"General Electric Company\",\"2\":\"148\"},{\"1\":\"AT&T INTELLECTUAL PROPERTY I, L.P.\",\"2\":\"146\"},{\"1\":\"Hewlett-Packard Development Company, L.P.\",\"2\":\"140\"},{\"1\":\"GM Global Technology Operations LLC\",\"2\":\"138\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n# Five most common USPCs for the global Top Ten companies (patent-wise) of 2014\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-5_bfe0e303b9ef560b0f48a7b4bee7a05f'}\n\n```{.r .cell-code}\n# type 2 and 3 are companies\ncompany_assignee_tbl <- assignee_tbl[assignee_tbl$type == \"2\" | assignee_tbl$type == \"3\",] |> rename(assignee_id = id)\n\n# global top ten for patents\nglobal_top_ten_frame <- company_assignee_tbl |> \n  inner_join(patent_assignee_tbl, by=\"assignee_id\") |> \n  group_by(assignee_id) |> \n  summarize(num_patents=n()) |> \n  arrange(desc(num_patents)) |> \n  head(10)\n\n# mapping company to uspc\n\ncompany_patent_uspc_tbl <- company_assignee_tbl |> \n  inner_join(patent_assignee_tbl, join_by(assignee_id)) |> \n  inner_join(uspc_tbl, by=\"patent_id\", relationship = \"many-to-many\")\n\n\n# for creation of final result frame\ncompany_uspc<- tibble(\n  name = character(),\n  fst = character(),\n  snd = character(),\n  third =  character(),\n  fourth =  character(),\n  fifth =  character()\n)\n\n# for each company in the top ten, get the 5 most common USPCs\nfor (company in global_top_ten_frame$assignee_id) {\n  top_uspc_codes <- company_patent_uspc_tbl[company_patent_uspc_tbl$assignee_id == company,] |>\n    group_by(mainclass_id) |> \n    summarize(count = n()) |> \n    arrange(desc(count)) |> \n    head(5)\n  \n  comp_name <- head(company_assignee_tbl[company_assignee_tbl$assignee_id==company,], 1)$organization\n  cls <- top_uspc_codes$mainclass_id\n\n  company_uspc <- company_uspc |> add_row(name=comp_name,\n                          fst=cls[1],\n                          snd = cls[2],\n                          third =  cls[3],\n                          fourth =  cls[4],\n                          fifth =  cls[5])\n}\n# Top Five USPCs for each of the global Top Ten Companies\ncompany_uspc\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"name\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"fst\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"snd\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"third\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"fourth\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"fifth\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"International Business Machines Corporation\",\"2\":\"257\",\"3\":\"438\",\"4\":\"709\",\"5\":\"711\",\"6\":\"717\"},{\"1\":\"Samsung Electronics Co., Ltd.\",\"2\":\"257\",\"3\":\"455\",\"4\":\"370\",\"5\":\"438\",\"6\":\"365\"},{\"1\":\"Canon Kabushiki Kaisha\",\"2\":\"358\",\"3\":\"348\",\"4\":\"399\",\"5\":\"382\",\"6\":\"347\"},{\"1\":\"Sony Corporation\",\"2\":\"348\",\"3\":\"345\",\"4\":\"257\",\"5\":\"725\",\"6\":\"455\"},{\"1\":\"Microsoft Corporation\",\"2\":\"709\",\"3\":\"707\",\"4\":\"715\",\"5\":\"717\",\"6\":\"726\"},{\"1\":\"Google Inc.\",\"2\":\"707\",\"3\":\"709\",\"4\":\"715\",\"5\":\"382\",\"6\":\"455\"},{\"1\":\"Kabushiki Kaisha Toshiba\",\"2\":\"257\",\"3\":\"365\",\"4\":\"438\",\"5\":\"348\",\"6\":\"711\"},{\"1\":\"QUALCOMM Incorporated\",\"2\":\"455\",\"3\":\"370\",\"4\":\"375\",\"5\":\"709\",\"6\":\"257\"},{\"1\":\"LG Electronics Inc.\",\"2\":\"370\",\"3\":\"455\",\"4\":\"725\",\"5\":\"375\",\"6\":\"715\"},{\"1\":\"Panasonic Corporation\",\"2\":\"257\",\"3\":\"348\",\"4\":\"438\",\"5\":\"375\",\"6\":\"370\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n# And the global Top Five tech sectors\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-6_ee0cfe43b35c73d2b7ea3751e30fbd83'}\n\n```{.r .cell-code}\ntop_uspc_codes <- company_patent_uspc_tbl[company_patent_uspc_tbl$assignee_id %in% global_top_ten_frame$assignee_id,] |>\n    group_by(mainclass_id) |> \n    summarize(count = n()) |> \n    arrange(desc(count)) |> \n    head(5)\n\n#Globally most innovative tech sectors\ntop_uspc_codes$mainclass_id\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"257\" \"455\" \"370\" \"348\" \"709\"\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}